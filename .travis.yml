language: python
python: 3.7

jobs:
  include:
  - stage: test
    python: 3.6
  - python: 3.7
  - python: 3.8
  - script:
    - pytest --cov=pydrad --cov-report=html
    - coveralls
  - stage: docs
    script:
    - cd docs && make && cd ..
    - mkdocs build -d site
    deploy:
      provider: pages
      skip_cleanup: true
      github_token: "$GH_TOKEN"
      local_dir: site
      target_branch: gh-pages

stages:
- name: install
- name: test
- name: deploy

install:
- pip install -r requirements/requirements-dev.txt
- pip install numpy>=1.16  # Travis sometimes has an older version
- python setup.py install
script: pytest

env:
  global:
    secure: UAJNM5iGgPmU6wlGLc2krhe8njsIRnWnssCl8we9y/C6VXDaYZBqOEsfsHDOKFPk1ocWLBYDFgatCVGamlVxNkLH54zz4Dd9nAtzY2iZe5kS/uq+N4eN7xTvDdFLG3NbleDH+G1NzNTqwm7Czc0T0issuVU5D2qyYfURdStHhIpCJt60lUe5WJDGrdWewKTtQCY8gNO66I9M6ZFM+1qhplXcSA9oOGiaM6lniI8FL6YPC6n778uWcSAfV9e2r70rR7QfitcQqCVJ+Iv6KqrVyhmJiHU8OITGvcGsVxSXwH04lBqc6tZpf3sadtrx4jsrqgpgfgmMBopDshQBGTeZMZVPI0wh2PFjON444LtrqpMW+o4h8Zewiv3MObETVCth4/TYV1J5cskGU/nk2ARZwpFRJa5foo3BBPqPpyTUt+2L0Ar1lc0xwfOq5tnPWSU5XKmot2tjgsv1idx3G0U4/oc+SVd+S4BUjh1iohGNp+8MY40l5uHTja6f/NAj3ZH9fi9pD559Zmz8Im5/+9ckeaCnys/O5vPoHcuGBDtPo11X70/d+SbrkhD6gpgLqdp4TTVaYAkFwWcJ4QNIZ4QaWeS2c5yLLiX7nHsqA9xPXdYm6rvKjXNvAdAd9xfSh7sPTn2a2u4mm6w6TAk0gqoYCixxIEGDfzUjdZ9vT899Jf8=
